# edash 数据源系统分析文档

## 1. 前端实现

### 1.1 数据源服务

- 文件位置: `client/app/services/data-source.js`
- 核心方法:
    
    ``const DataSource = {   types: () => axios.get("api/data_sources/types"), // 获取所有数据源类型   query: () => axios.get("api/data_sources"),       // 查询数据源列表   create: (data) => axios.post(`api/data_sources`, data) // 创建数据源 }``
    

### 1.2 创建数据源对话框

- 文件位置: `client/app/components/CreateSourceDialog.jsx`
- 功能特点:
    - 通过props接收`types`属性展示可选数据源
    - 实现搜索过滤功能
    - 分步表单配置数据源

## 2. 后端实现

### 2.1 数据源类型管理

- 文件位置: `redash/cli/data_sources.py`
- 核心功能:
    
    python
    
    CopyInsert
    
    `@manager.command(name="list_types") def list_types():     types = sorted(query_runners.keys())  # 获取所有已注册的查询执行器(数据源类型)     ... def validate_data_source_type(type):     if type not in query_runners.keys():  # 验证数据源类型是否有效         ...`
    

### 2.2 API端点

- 前端调用: `GET api/data_sources/types`
- 返回格式: JSON数组，包含所有支持的数据源类型信息

## 3. 系统架构

mermaid

CopyInsert

`graph TD    A[前端] -->|请求类型列表| B(API: /data_sources/types)     B --> C[后端路由]     C --> D[查询query_runners]     D --> E[返回类型列表]`

## 4. 关键流程

1. 前端初始化时调用`DataSource.types()`获取所有支持的数据源类型
2. 用户打开创建对话框，展示过滤后的数据源类型列表
3. 用户选择类型后，进入配置表单
4. 提交表单时调用`DataSource.create()`创建新数据源

## 5. 扩展机制

- 新增数据源类型需要:
    1. 在后端注册新的query_runner
    2. 实现对应的配置表单前端组件
    3. 添加类型图标资源