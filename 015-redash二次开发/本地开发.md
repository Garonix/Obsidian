## 安装所需的软件包

```shell
# 安装docker
wget -qO- get.docker.com | bash
docker -v  # 查看docker版本
systemctl enable docker  # 设置开机自动启动
sudo apt -y install build-essential curl pwgen python3-venv xvfb
```

## 将当前用户添加到 "docker" 组

```shell
sudo usermod -aG docker $USER
newgrp docker
sudo systemctl restart docker
sudo chmod 666 /var/run/docker.sock
```

## 安装NVM

```shell
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash
```

## 安装 NodeJS 版本 18

```shell
nvm install --lts 18
nvm alias default 18
nvm use 18
```

## 安装 Yarn 1.x

```shell
npm install -g yarn@1.22.22
```

## 安装 NodeJS 依赖

```shell
yarn
```

## 构建 Redash 前端

```shell
make build
```

## 构建本地 Redash Docker 镜像

```shell
make compose_build
```

# 本地启动 Redash，使用刚构建的 docker 镜像

```shell
make create_database
```



```shell
# 启动容器，删除旧开发server
make up
# 停止server服务
docker compose stop server
# 热重载开发
docker compose run --rm -p 5001:5000 server dev_server
```

查询语句

100 - avg by (instance) (rate(node_cpu_seconds_total{mode="idle"}[{{minute}}m])) * 100